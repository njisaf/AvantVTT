{{!--
Item Header Partial - Fully Configurable Header Layout

This partial provides a standardized header layout for all item sheets.
It uses the layout system to render all header fields from metaFields array,
respecting the exact order and configuration from the layout system.

Required context:
- item: The item data object
- metaFields: Array of field objects prepared by prepareItemHeaderMetaFields()

Features:
- Fully configurable through layout system
- Support for all field types (image-upload, text, number, ap-selector, etc.)
- Side-by-side field placement with sideBy helper
- Full-width field support
- Responsive design with mobile support
- Consistent spacing and alignment
--}}

<header class="tw-sheet-header">
  {{#if metaFields}}
  {{#each metaFields as |field fieldIndex|}}
  {{#if field.fullWidth}}
  {{!-- Full-width fields get their own container --}}
  <div class="tw-row-container tw-row-full-width">
    {{> "systems/avant/templates/shared/partials/render-field" field=field editable=editable
    displayTraits=displayTraits}}
  </div>
  {{else if field.sideBy}}
  {{!-- Side-by-side fields get a shared container --}}
  <div class="tw-row-container tw-row-side-by-side" data-field-index="{{fieldIndex}}">
    {{#each field.fields as |subField|}}
    {{> "systems/avant/templates/shared/partials/render-field" field=subField editable=editable
    displayTraits=displayTraits}}
    {{/each}}
  </div>
  {{else}}
  {{!-- Regular fields get individual containers --}}
  <div class="tw-row-container tw-field-container" data-field-index="{{fieldIndex}}">
    {{> "systems/avant/templates/shared/partials/render-field" field=field editable=editable
    displayTraits=displayTraits}}
  </div>
  {{/if}}
  {{/each}}
  {{else}}
  {{!-- Fallback to hardcoded header if metaFields is not available --}}
  <div class="tw-row-container tw-header-main">
    {{!-- Image Upload Component --}}
    <div class="tw-form-group">
      {{> "systems/avant/templates/shared/partials/image-upload"
      src=item.img
      alt=item.name
      title=item.name
      size=48
      class="tw-item-icon"}}
    </div>

    {{!-- Name Field --}}
    <div class="tw-form-group">
      {{> "systems/avant/templates/shared/partials/text-field"
      name="name"
      value=item.name
      label="Item Name"
      placeholder=(concat "Enter " (titleCase item.type) " name...")
      required=true
      class="tw-item-name-field"}}
    </div>
  </div>
  {{/if}}
</header>
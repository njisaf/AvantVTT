# Spec 06.2 Â· Action Card Stat Tile Refactor
**Version:** 1.0.0
**Status:** Active

## 1. Summary
This specification details the refactoring of the "stat-tile" components used in the unified action card system. The goal is to create a visually consistent, responsive, and accessible presentation for all secondary statistics (e.g., Damage, Range, AP Cost) and primary combat thresholds (Attack and Defense). This includes centralizing the threshold calculation logic and consolidating conflicting global styles.

## 2. Requirements

| ID | Requirement | Rationale |
|---|---|---|
| 6.2.1 | The "Attack Threshold" and "Defense Threshold" values must be computed at runtime. | To ensure the UI accurately reflects a character's current stats as they change. |
| 6.2.2 | The threshold formula (`11 + Level + Ability Mod + Expertise`) must be centralized. | To create a single source of truth for combat calculations and improve maintainability. |
| 6.2.3 | All `stat-tile` components on action cards must have a uniform width and height. | To ensure a clean, modern, and readable grid layout across all item types. |
| 6.2.4 | The decorative underline on stat tiles must be removed. | To modernize the design and improve visual consistency. |
| 6.2.5 | Threshold tiles must be visually distinct with a neon-blue highlight. | To draw attention to these primary combat stats. |
| 6.2.6 | The Threshold tile's color contrast must meet WCAG 2.2 AA standards. | To ensure accessibility for all users in both light and dark modes. |
| 6.2.7 | All other stat tiles must have a 2px magenta border for clearer separation. | To improve visual hierarchy and distinguish them from the primary threshold tiles. |
| 6.2.8 | Styling for stat tiles must be scoped to prevent global conflicts. | To ensure component-specific styles do not unintentionally affect other UI elements. |

## 3. Implementation Details
*   **Threshold Calculation**: A `computeThreshold` function was added to `scripts/logic/rolls-utils.ts` and is called by `createGearAction` in `scripts/logic/unified-actions.ts`.
*   **Styling**:
    *   The `stat-tile` styles were moved from `styles/avant.scss` to `styles/components/_unified-actions.scss` and scoped to the `.unified-action-item` class.
    *   A new `.sidebar-stat-tile` class was created in `styles/avant.scss` for the actor sheet sidebar to prevent style clashes.
    *   The `templates/actor/core.hbs` template was updated to use the new `.sidebar-stat-tile` class.

## 4. Acceptance Criteria

| AC | Test |
|---|---|
| 6.2.a | The "Attack Threshold" and "Defense Threshold" values on action cards update when an actor's level, ability modifiers, or expertise change. |
| 6.2.b | Stat tiles on all action cards are the same size. |
| 6.2.c | Threshold tiles have a distinct blue highlight, while other tiles have a 2px magenta border. |
| 6.2.d | Stat tiles on the actor sheet sidebar are not affected by the action card styles. |

## 5. Open Questions
*   None at this time.